---
// https://github.com/withastro/starlight/blob/main/packages/starlight/user-components/Aside.astro
import { AstroError } from "astro/errors";

import { Icon } from "astro-icon/components";

const asideVariants = ["info", "tip", "caution", "danger"] as const;
const icons = {
  info: "tabler/info-circle",
  tip: "tabler/bulb",
  caution: "tabler/alert-triangle",
  danger: "tabler/flame",
} as const;

interface Props {
  type?: (typeof asideVariants)[number];
  title?: string;
}

let { type = "info", title } = Astro.props;

if (!asideVariants.includes(type)) {
  throw new AstroError(
    "Invalid `type` prop passed to the `<Aside>` component.\n",
    `Received: ${JSON.stringify(type)}\n` +
      `Expected one of ${asideVariants.map((i) => JSON.stringify(i)).join(", ")}`
  );
}

if (!title) {
  title = type.toUpperCase();
}
---

<style>
  .aside > .aside-container {
    --un-bg-opacity: 0.07;

    &.aside-tip {
      --primary: 234 60% 60%;
    }
    &.aside-caution {
      --primary: 41 90% 50%;
    }
    &.aside-danger {
      --primary: 339 90% 60%;
    }

    .aside-content {
      & > :first-child {
        margin-top: 0;
      }
      & > :last-child {
        margin-bottom: 0;
      }
    }
  }
</style>

<aside aria-label={title} class="aside my-3 overflow-hidden">
  <div
    class:list={[
      "border-l-8 border px-4 py-3 dark:text-white rounded-xl",
      {
        "prose-code:bg-blue-700/20 border-green-400 dark:border-green-600 dark:bg-green-400/30 bg-green-400/10 text-green-950":
          type === "tip",
      },
      {
        "prose-code:bg-yellow-400/20 border-yellow-400 dark:yellow-green-900 dark:bg-yellow-400/30 bg-yellow-400/10 text-yellow-950":
          type === "caution",
      },
      {
        "prose-code:bg-red-400/20 border-red-400 dark:border-red-800 dark:bg-red-400/30 bg-red-400/10 text-red-950":
          type === "danger",
      },
      {
        "prose-code:bg-sky-400/20 border-gray-400 dark:border-gray-600 dark:bg-gray-400/30 bg-gray-400/10 text-gray-950":
          type === "info",
      },
    ]}
  >
    <p class="not-prose flex items-center gap-x-2 font-bold" aria-hidden="true">
      <Icon name={icons[type]} />
      {title}
    </p>
    <div class="aside-content mt-2">
      <slot />
    </div>
  </div>
</aside>
